clear
clc
tspan = 0:.01:15;
dsupData = [1.76385542200000,1.06024096400000,0.651655629000000,0.678122935000000,0.752129472000000,0.606222222000000,0.658515284000000,0.765597148000000,0.927687916000000,0.746999077000000;0.963855422000000,0.865060241000000,0.645695364000000,0.550561798000000,0.602214651000000,0.589333333000000,0.558078603000000,0.637254902000000,0.581351094000000,0.506001847000000;0.583132530000000,0.590361446000000,0.600662252000000,0.459352280000000,0.432708688000000,0.429333333000000,0.408733624000000,0.455436720000000,0.488106565000000,0.421975993000000;0.0144578310000000,0.0168674700000000,0.570860927000000,0.268341044000000,0.301533220000000,0.313777778000000,0.278602620000000,0.348484848000000,0.296860133000000,0.227146814000000];
nonResist = [0.533622560000000,0.457820738000000,0.782442748000000,0,0.781376518000000;0.319956616000000,0.217047452000000,0.656488550000000,0.660583942000000,0.408906883000000;0.0368763560000000,0.00878734600000000,0.374045802000000,0.299270073000000,0.425101215000000;0,0,0.0725190840000000,0.0839416060000000,0.0526315790000000];
%nonResist = [0.533622560000000,0.457820738000000;0.319956616000000,0.217047452000000;0.0368763560000000,0.00878734600000000;0,0];
Nmax = 1.9823*10^10;
N0 = 3.13*10^5;
Nmin = 312999;
f=0.9174;
c=0.74;
k1=0.008098;
k2=0.003947;
I_obs=0.03;
I_test= .3;
lambda = .000583333;
%lambda = 0;
noUV=false;
td = 5.5;
fix = true;
%modList = cell(1,10);
%y_surv = cell(1,10);

lambdaRes = paramEst(tspan,I_obs,.0002,.01,f,k1,k2,.0001,dsupData);
lambdaNorm = paramEst(tspan,I_obs,.0002,.01,f,k1,k2,.0001,nonResist);

% Ieff = IeffCurve(tspan,I,lambda);
% Ieff_dsup = IeffCurve(tspan,I,ifOnly);
% y_norm = diag(feval(@(t) S(t,f,k1,k2,Ieff),tspan));
% y_dsup = diag(feval(@(t) S(t,f,k1,k2,Ieff_dsup),tspan));
% modNorm = fit(rot90(tspan,3),y_norm,'exp2');
% modDsup = fit(rot90(tspan,3),y_dsup,'exp2');
% plot(modNorm);
% hold on
% plot(modDsup);
%for I_test = .01:.05:.31
Ieff_dsup = IeffCurve(tspan, I_test, lambdaRes);
Ieff_norm = IeffCurve(tspan,I_test,lambdaNorm);
plot(t_dsup,y_dsup)
hold on
plot(t_norm,y_norm)
